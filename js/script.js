'use strict';

$(function () {

	// Главный слайдер 
	function introSlider(data) {
		var autoPlaySlides = data.autoPlay || false,
		    autoPlaySlidesSpeed = data.autoPlaySpeed || 1000,
		    slider = $(data.slider),
		    controls = $(slider).find('.controls').get(0);

		function autoPlay(seconds) {
			setInterval(function () {
				$(controls).find('.controls__arrow_next').trigger('click');
			}, seconds);
		}

		// Счётчик слайдов
		function count() {
			var count = $(controls).find('.controls__count'),
			    slides = $(slider).find('.intro__slide').length,
			    active = $(slider).find('.intro__slide.active').index() + 1;

			$(count).text(active + ' / ' + slides).addClass('change');
			setTimeout(function () {
				$(count).removeClass('change');
			}, 100);
		}

		// Следующий слайд
		function nextSlide() {
			var next = $(slider).find('.intro__slide.active').next().get(0) == undefined ? $(slider).find('.intro__slide').first().get(0) : $(slider).find('.intro__slide.active').next().get(0);
			activeContent(next);
		}

		// Предыдущий слайд
		function prevSlide() {
			var prev = $(slider).find('.intro__slide.active').prev().get(0) === undefined ? $(slider).find('.intro__slide').last() : $(slider).find('.intro__slide.active').prev().get(0);
			activeContent(prev);
		}

		// Замена контента
		function activeContent(slide) {
			var active = slide ? slide : $(slider).find('.intro__slide.active'),
			    contentSlide = $(active).find('.intro__slide-content').html(),
			    content = $(slider).find('.intro__content'),
			    link = $(active).data('link'),
			    altSlide = $(active).find('.intro__slide-alt').html(),
			    alt = $(slider).find('.intro__alt');

			$(slider).find('.intro__slide.active').removeClass('active');
			$(active).addClass('active');

			$(content).addClass('change').html(contentSlide);
			$(slider).find('.intro__more').attr('href', link);

			$(alt).addClass('change');

			count();

			setTimeout(function () {
				$(alt).removeClass('change').empty().append(altSlide);
				var gallery = $(alt).find('.gallery').get(0);

				if (gallery) {
					$(gallery).find('.gallery__slides').slick({
						infinite: true,
						// autoplay: 3000,
						slidesToShow: 1,
						arrows: true,
						fade: true,
						prevArrow: $('.controls_gallery .controls__arrow_prev'),
						nextArrow: $('.controls_gallery .controls__arrow_next')
					});
				}
			}, 500);

			setTimeout(function () {
				$(content).removeClass('change');
			}, 300);
		}

		$(slider).find('.intro__slide').first().addClass('active');

		activeContent();

		$(slider).find('.controls__arrow').on('click', function () {
			var direction = $(this).hasClass('controls__arrow_next');

			switch (direction) {
				case true:
					nextSlide();
					break;
				case false:
					prevSlide();
					break;
			}
		});

		if (autoPlaySlides) autoPlay(autoPlaySlidesSpeed);
	}

	introSlider({
		slider: $('[data-slider="intro"]'),
		autoPlay: true,
		autoPlaySpeed: 5000
	});

	introSlider({
		slider: $('[data-slider="specialists"]'),
		autoPlay: true,
		autoPlaySpeed: 5000
	});

	function brandsSlider() {
		function refresh() {
			var slides = $('.brands__list .brand').children().length,
			    current = $('.brand.slick-current'),
			    index = $(current).index() + 1,
			    img = $(current).data('image'),
			    image = $('.brands__image');

			if (String(slides).length === 1) slides = '0' + slides;
			if (String(index).length === 1) index = '0' + index;

			$('.brands__count span').first().text(index);
			$('.brands__count span').last().text(slides);

			$(image).addClass('change');

			setTimeout(function () {
				$(image).css({
					'background-image': 'url(' + img + ')'
				});
				$(image).removeClass('change');
			}, 100);
		}

		$('.brands__list').slick({
			infinite: true,
			fade: true,
			arrows: true,
			autoplay: true,
			autoplaySpeed: 5000,
			pauseOnHover: false,
			prevArrow: $('.controls_brands .controls__arrow_prev'),
			nextArrow: $('.controls_brands .controls__arrow_next')
		});

		$('.brands__list').on('afterChange', refresh);

		refresh();
	}

	brandsSlider();

	function gallery() {
		$('.gallery').each(function (i, gallery) {
			if ($(gallery).hasClass('gallery_spec')) return;

			$(gallery).find('.gallery__slides').slick({
				infinite: true,
				autoplay: 3000,
				slidesToShow: 1,
				arrows: true,
				fade: true,
				prevArrow: $('.controls_gallery .controls__arrow_prev'),
				nextArrow: $('.controls_gallery .controls__arrow_next')
			});

			function titleSetup(title) {
				var delay = 150;

				$(titles).fadeOut(delay, function () {
					$(this).html(title).fadeIn(delay);
				});
			}

			var titles = $(gallery).find('.gallery__title').get(0);

			if (titles) {
				var title = $(gallery).find('.slick-current').data('title');
				titleSetup(title);

				$(gallery).find('.gallery__slides').on('beforeChange', function (e, slick, currentSlide, nextSlide) {
					var index = nextSlide,
					    slide = $(gallery).find('.gallery__item').get(index),
					    title = $(slide).data('title');

					titleSetup(title);
				});
			}
		});
	}

	gallery();

	// Простые слайдеры
	$('.slider').each(function (i, slider) {
		var sl = $(slider).find('.slider__list');

		sl.slick({
			variableWidth: true,
			centerMode: true,
			arrows: true,
			prevArrow: $(slider).find('.controls__arrow_prev'),
			nextArrow: $(slider).find('.controls__arrow_next')
		});

		var bigImg = $(slider).data('bigimg');

		if (bigImg) {
			var big = $('.' + bigImg).get(0);

			$(big).html($(sl).find('.slick-current img').clone());

			$(sl).on('.slider__item').on('click', function (e) {
				e.preventDefault();

				var img = $(this).find('img').clone();

				$(big).empty().html(img);
			});
		}
	});

	// bpopup
	$('[data-bpopup]').on('click', function (e) {
		e.preventDefault();

		var img = $(this).find('img').clone(),
		    imgWrap = '<div class="bpopup-wrap-image"></div>';

		$('body').append(imgWrap);
		$(imgWrap).append(img).bPopup().reposition(300);
	});

	// Карта
	var map = $('#map').get(0);

	if (map) {
		var init = function init() {
			myMap = new ymaps.Map("map", {
				center: [53.334136, 83.793247],
				zoom: 17,
				controls: []
			});

			myPlacemark = new ymaps.Placemark([53.334136, 83.793247], {
				hintContent: 'ТД Ultra'
			});

			myMap.geoObjects.add(myPlacemark);
		};

		ymaps.ready(init);

		var myMap, myPlacemark;
	}

	// Красивые селекты
	$('select').niceSelect();

	// Мобильное меню
	$('.menu').on('click', function () {
		$(this).parent().toggleClass('menu-open');
	});

	// Поиск
	searchComponent();

	function searchComponent() {
		var search = $('.search');

		$('.search__btn').on('click', function () {
			if ($(window).width() > 768) return;

			$(search).toggleClass('search-open');
			$(search).find('input').focus();
		});

		$('.search__clear').on('click', function () {
			$(search).find('.search__field input').val('').focus();
		});
	}

	// Сравнение
	$('.result__compare').twentytwenty({
		before_label: 'До',
		after_label: 'После'
	});

	// tilt js
	$('.sertificate').tilt();

	// Плавающая шапка
	$('body').append($('.header__main').clone().addClass('fixed'));

	$(window).on('scroll', function () {
		if ($(window).width() <= 1000) {
			$('.header__main.fixed.show').removeClass('show');
			return;
		}

		var scroll = $(window).scrollTop();

		if (scroll >= 200) {
			$('.header__main.fixed').addClass('show');
		} else {
			$('.header__main.fixed.show').removeClass('show');
		}
	});

	// Модальные окна
	$('[data-open]').on('click', function (e) {
		e.preventDefault();

		var modal = $('[data-modal="' + $(this).data('open') + '"]').get(0);

		$(modal).bPopup({
			closeClass: 'modal__close'
		});
	});
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyIkIiwiaW50cm9TbGlkZXIiLCJkYXRhIiwiYXV0b1BsYXlTbGlkZXMiLCJhdXRvUGxheSIsImF1dG9QbGF5U2xpZGVzU3BlZWQiLCJhdXRvUGxheVNwZWVkIiwic2xpZGVyIiwiY29udHJvbHMiLCJmaW5kIiwiZ2V0Iiwic2Vjb25kcyIsInNldEludGVydmFsIiwidHJpZ2dlciIsImNvdW50Iiwic2xpZGVzIiwibGVuZ3RoIiwiYWN0aXZlIiwiaW5kZXgiLCJ0ZXh0IiwiYWRkQ2xhc3MiLCJzZXRUaW1lb3V0IiwicmVtb3ZlQ2xhc3MiLCJuZXh0U2xpZGUiLCJuZXh0IiwidW5kZWZpbmVkIiwiZmlyc3QiLCJhY3RpdmVDb250ZW50IiwicHJldlNsaWRlIiwicHJldiIsImxhc3QiLCJzbGlkZSIsImNvbnRlbnRTbGlkZSIsImh0bWwiLCJjb250ZW50IiwibGluayIsImFsdFNsaWRlIiwiYWx0IiwiYXR0ciIsImVtcHR5IiwiYXBwZW5kIiwiZ2FsbGVyeSIsInNsaWNrIiwiaW5maW5pdGUiLCJzbGlkZXNUb1Nob3ciLCJhcnJvd3MiLCJmYWRlIiwicHJldkFycm93IiwibmV4dEFycm93Iiwib24iLCJkaXJlY3Rpb24iLCJoYXNDbGFzcyIsImJyYW5kc1NsaWRlciIsInJlZnJlc2giLCJjaGlsZHJlbiIsImN1cnJlbnQiLCJpbWciLCJpbWFnZSIsIlN0cmluZyIsImNzcyIsImF1dG9wbGF5IiwiYXV0b3BsYXlTcGVlZCIsInBhdXNlT25Ib3ZlciIsImVhY2giLCJpIiwidGl0bGVTZXR1cCIsInRpdGxlIiwiZGVsYXkiLCJ0aXRsZXMiLCJmYWRlT3V0IiwiZmFkZUluIiwiZSIsImN1cnJlbnRTbGlkZSIsInNsIiwidmFyaWFibGVXaWR0aCIsImNlbnRlck1vZGUiLCJiaWdJbWciLCJiaWciLCJjbG9uZSIsInByZXZlbnREZWZhdWx0IiwiaW1nV3JhcCIsImJQb3B1cCIsInJlcG9zaXRpb24iLCJtYXAiLCJpbml0IiwibXlNYXAiLCJ5bWFwcyIsIk1hcCIsImNlbnRlciIsInpvb20iLCJteVBsYWNlbWFyayIsIlBsYWNlbWFyayIsImhpbnRDb250ZW50IiwiZ2VvT2JqZWN0cyIsImFkZCIsInJlYWR5IiwibmljZVNlbGVjdCIsInBhcmVudCIsInRvZ2dsZUNsYXNzIiwic2VhcmNoQ29tcG9uZW50Iiwic2VhcmNoIiwid2luZG93Iiwid2lkdGgiLCJmb2N1cyIsInZhbCIsInR3ZW50eXR3ZW50eSIsImJlZm9yZV9sYWJlbCIsImFmdGVyX2xhYmVsIiwidGlsdCIsInNjcm9sbCIsInNjcm9sbFRvcCIsIm1vZGFsIiwiY2xvc2VDbGFzcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsRUFBRSxZQUFXOztBQUVaO0FBQ0EsVUFBU0MsV0FBVCxDQUFxQkMsSUFBckIsRUFBMkI7QUFDMUIsTUFBSUMsaUJBQWlCRCxLQUFLRSxRQUFMLElBQWlCLEtBQXRDO0FBQUEsTUFDQ0Msc0JBQXNCSCxLQUFLSSxhQUFMLElBQXNCLElBRDdDO0FBQUEsTUFFQ0MsU0FBU1AsRUFBRUUsS0FBS0ssTUFBUCxDQUZWO0FBQUEsTUFHQ0MsV0FBV1IsRUFBRU8sTUFBRixFQUFVRSxJQUFWLENBQWUsV0FBZixFQUE0QkMsR0FBNUIsQ0FBZ0MsQ0FBaEMsQ0FIWjs7QUFLQSxXQUFTTixRQUFULENBQWtCTyxPQUFsQixFQUEyQjtBQUMxQkMsZUFBWSxZQUFXO0FBQ3RCWixNQUFFUSxRQUFGLEVBQVlDLElBQVosQ0FBaUIsdUJBQWpCLEVBQTBDSSxPQUExQyxDQUFrRCxPQUFsRDtBQUNBLElBRkQsRUFFR0YsT0FGSDtBQUdBOztBQUVEO0FBQ0EsV0FBU0csS0FBVCxHQUFpQjtBQUNoQixPQUFJQSxRQUFRZCxFQUFFUSxRQUFGLEVBQVlDLElBQVosQ0FBaUIsa0JBQWpCLENBQVo7QUFBQSxPQUNDTSxTQUFTZixFQUFFTyxNQUFGLEVBQVVFLElBQVYsQ0FBZSxlQUFmLEVBQWdDTyxNQUQxQztBQUFBLE9BRUNDLFNBQVNqQixFQUFFTyxNQUFGLEVBQVVFLElBQVYsQ0FB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QUFqQjs7QUFFQXBCLEdBQUVxRyxNQUFGLEVBQVVwRCxFQUFWLENBQWEsUUFBYixFQUF1QixZQUFXO0FBQ2pDLE1BQUlqRCxFQUFFcUcsTUFBRixFQUFVQyxLQUFWLE1BQXFCLElBQXpCLEVBQStCO0FBQzlCdEcsS0FBRSwwQkFBRixFQUE4QnNCLFdBQTlCLENBQTBDLE1BQTFDO0FBQ0E7QUFDQTs7QUFFRCxNQUFJdUYsU0FBUzdHLEVBQUVxRyxNQUFGLEVBQVVTLFNBQVYsRUFBYjs7QUFFQSxNQUFJRCxVQUFVLEdBQWQsRUFBbUI7QUFDbEI3RyxLQUFFLHFCQUFGLEVBQXlCb0IsUUFBekIsQ0FBa0MsTUFBbEM7QUFDQSxHQUZELE1BRU87QUFDTnBCLEtBQUUsMEJBQUYsRUFBOEJzQixXQUE5QixDQUEwQyxNQUExQztBQUNBO0FBQ0QsRUFiRDs7QUFlQTtBQUNBdEIsR0FBRSxhQUFGLEVBQWlCaUQsRUFBakIsQ0FBb0IsT0FBcEIsRUFBNkIsVUFBU3NCLENBQVQsRUFBWTtBQUN4Q0EsSUFBRVEsY0FBRjs7QUFFQSxNQUFJZ0MsUUFBUS9HLEVBQUUsa0JBQWdCQSxFQUFFLElBQUYsRUFBUUUsSUFBUixDQUFhLE1BQWIsQ0FBaEIsR0FBcUMsSUFBdkMsRUFBNkNRLEdBQTdDLENBQWlELENBQWpELENBQVo7O0FBRUFWLElBQUUrRyxLQUFGLEVBQVM5QixNQUFULENBQWdCO0FBQ2YrQixlQUFZO0FBREcsR0FBaEI7QUFHQSxFQVJEO0FBVUEsQ0F2VUQiLCJmaWxlIjoic2NyaXB0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiJChmdW5jdGlvbigpIHtcblxuXHQvLyDQk9C70LDQstC90YvQuSDRgdC70LDQudC00LXRgCBcblx0ZnVuY3Rpb24gaW50cm9TbGlkZXIoZGF0YSkge1xuXHRcdHZhciBhdXRvUGxheVNsaWRlcyA9IGRhdGEuYXV0b1BsYXkgfHwgZmFsc2UsXG5cdFx0XHRhdXRvUGxheVNsaWRlc1NwZWVkID0gZGF0YS5hdXRvUGxheVNwZWVkIHx8IDEwMDAsXG5cdFx0XHRzbGlkZXIgPSAkKGRhdGEuc2xpZGVyKSxcblx0XHRcdGNvbnRyb2xzID0gJChzbGlkZXIpLmZpbmQoJy5jb250cm9scycpLmdldCgwKTtcblxuXHRcdGZ1bmN0aW9uIGF1dG9QbGF5KHNlY29uZHMpIHtcblx0XHRcdHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkKGNvbnRyb2xzKS5maW5kKCcuY29udHJvbHNfX2Fycm93X25leHQnKS50cmlnZ2VyKCdjbGljaycpO1xuXHRcdFx0fSwgc2Vjb25kcyk7XG5cdFx0fVxuXG5cdFx0Ly8g0KHRh9GR0YLRh9C40Log0YHQu9Cw0LnQtNC+0LJcblx0XHRmdW5jdGlvbiBjb3VudCgpIHtcblx0XHRcdHZhciBjb3VudCA9ICQoY29udHJvbHMpLmZpbmQoJy5jb250cm9sc19fY291bnQnKSxcblx0XHRcdFx0c2xpZGVzID0gJChzbGlkZXIpLmZpbmQoJy5pbnRyb19fc2xpZGUnKS5sZW5ndGgsXG5cdFx0XHRcdGFjdGl2ZSA9ICQoc2xpZGVyKS5maW5kKCcuaW50cm9fX3NsaWRlLmFjdGl2ZScpLmluZGV4KCkrMTtcblxuXHRcdFx0JChjb3VudCkudGV4dChhY3RpdmUrJyAvICcrc2xpZGVzKS5hZGRDbGFzcygnY2hhbmdlJyk7XG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkKGNvdW50KS5yZW1vdmVDbGFzcygnY2hhbmdlJyk7XG5cdFx0XHR9LCAxMDApXG5cdFx0fVxuXG5cdFx0Ly8g0KHQu9C10LTRg9GO0YnQuNC5INGB0LvQsNC50LRcblx0XHRmdW5jdGlvbiBuZXh0U2xpZGUoKSB7XG5cdFx0XHR2YXIgbmV4dCA9ICgkKHNsaWRlcikuZmluZCgnLmludHJvX19zbGlkZS5hY3RpdmUnKS5uZXh0KCkuZ2V0KDApID09IHVuZGVmaW5lZCkgPyAkKHNsaWRlcikuZmluZCgnLmludHJvX19zbGlkZScpLmZpcnN0KCkuZ2V0KDApIDogJChzbGlkZXIpLmZpbmQoJy5pbnRyb19fc2xpZGUuYWN0aXZlJykubmV4dCgpLmdldCgwKTtcblx0XHRcdGFjdGl2ZUNvbnRlbnQobmV4dCk7XG5cdFx0fVxuXG5cdFx0Ly8g0J/RgNC10LTRi9C00YPRidC40Lkg0YHQu9Cw0LnQtFxuXHRcdGZ1bmN0aW9uIHByZXZTbGlkZSgpIHtcblx0XHRcdHZhciBwcmV2ID0gKCQoc2xpZGVyKS5maW5kKCcuaW50cm9fX3NsaWRlLmFjdGl2ZScpLnByZXYoKS5nZXQoMCkgPT09IHVuZGVmaW5lZCkgPyAkKHNsaWRlcikuZmluZCgnLmludHJvX19zbGlkZScpLmxhc3QoKSA6ICQoc2xpZGVyKS5maW5kKCcuaW50cm9fX3NsaWRlLmFjdGl2ZScpLnByZXYoKS5nZXQoMCk7XG5cdFx0XHRhY3RpdmVDb250ZW50KHByZXYpO1xuXHRcdH1cblxuXHRcdC8vINCX0LDQvNC10L3QsCDQutC+0L3RgtC10L3RgtCwXG5cdFx0ZnVuY3Rpb24gYWN0aXZlQ29udGVudChzbGlkZSkge1xuXHRcdFx0dmFyIGFjdGl2ZSA9IChzbGlkZSkgPyBzbGlkZSA6ICQoc2xpZGVyKS5maW5kKCcuaW50cm9fX3NsaWRlLmFjdGl2ZScpLFxuXHRcdFx0XHRjb250ZW50U2xpZGUgPSAkKGFjdGl2ZSkuZmluZCgnLmludHJvX19zbGlkZS1jb250ZW50JykuaHRtbCgpLFxuXHRcdFx0XHRjb250ZW50ID0gJChzbGlkZXIpLmZpbmQoJy5pbnRyb19fY29udGVudCcpLFxuXHRcdFx0XHRsaW5rID0gJChhY3RpdmUpLmRhdGEoJ2xpbmsnKSxcblx0XHRcdFx0YWx0U2xpZGUgPSAkKGFjdGl2ZSkuZmluZCgnLmludHJvX19zbGlkZS1hbHQnKS5odG1sKCksXG5cdFx0XHRcdGFsdCA9ICQoc2xpZGVyKS5maW5kKCcuaW50cm9fX2FsdCcpO1xuXG5cdFx0XHQkKHNsaWRlcikuZmluZCgnLmludHJvX19zbGlkZS5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cdFx0XHQkKGFjdGl2ZSkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG5cdFx0XHQkKGNvbnRlbnQpLmFkZENsYXNzKCdjaGFuZ2UnKS5odG1sKGNvbnRlbnRTbGlkZSk7XG5cdFx0XHQkKHNsaWRlcikuZmluZCgnLmludHJvX19tb3JlJykuYXR0cignaHJlZicsIGxpbmspO1xuXG5cdFx0XHQkKGFsdCkuYWRkQ2xhc3MoJ2NoYW5nZScpO1xuXG5cdFx0XHRjb3VudCgpO1xuXG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkKGFsdCkucmVtb3ZlQ2xhc3MoJ2NoYW5nZScpLmVtcHR5KCkuYXBwZW5kKGFsdFNsaWRlKTtcblx0XHRcdFx0dmFyIGdhbGxlcnkgPSAkKGFsdCkuZmluZCgnLmdhbGxlcnknKS5nZXQoMCk7XG5cblx0XHRcdFx0aWYgKGdhbGxlcnkpIHtcblx0XHRcdFx0XHQkKGdhbGxlcnkpLmZpbmQoJy5nYWxsZXJ5X19zbGlkZXMnKS5zbGljayh7XG5cdFx0XHRcdFx0XHRpbmZpbml0ZTogdHJ1ZSxcblx0XHRcdFx0XHRcdC8vIGF1dG9wbGF5OiAzMDAwLFxuXHRcdFx0XHRcdFx0c2xpZGVzVG9TaG93OiAxLFxuXHRcdFx0XHRcdFx0YXJyb3dzOiB0cnVlLFxuXHRcdFx0XHRcdFx0ZmFkZTogdHJ1ZSxcblx0XHRcdFx0XHRcdHByZXZBcnJvdzogJCgnLmNvbnRyb2xzX2dhbGxlcnkgLmNvbnRyb2xzX19hcnJvd19wcmV2JyksXG5cdFx0XHRcdFx0XHRuZXh0QXJyb3c6ICQoJy5jb250cm9sc19nYWxsZXJ5IC5jb250cm9sc19fYXJyb3dfbmV4dCcpXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH0sIDUwMCk7XG5cblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdCQoY29udGVudCkucmVtb3ZlQ2xhc3MoJ2NoYW5nZScpO1xuXHRcdFx0fSwgMzAwKTtcblx0XHR9XG5cblx0XHQkKHNsaWRlcikuZmluZCgnLmludHJvX19zbGlkZScpLmZpcnN0KCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG5cdFx0YWN0aXZlQ29udGVudCgpO1xuXG5cdFx0JChzbGlkZXIpLmZpbmQoJy5jb250cm9sc19fYXJyb3cnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBkaXJlY3Rpb24gPSAkKHRoaXMpLmhhc0NsYXNzKCdjb250cm9sc19fYXJyb3dfbmV4dCcpO1xuXHRcdFx0XG5cdFx0XHRzd2l0Y2ggKGRpcmVjdGlvbikge1xuXHRcdFx0XHRjYXNlIHRydWU6XG5cdFx0XHRcdFx0bmV4dFNsaWRlKCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgZmFsc2U6XG5cdFx0XHRcdFx0cHJldlNsaWRlKCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fSlcblxuXHRcdGlmIChhdXRvUGxheVNsaWRlcykgYXV0b1BsYXkoYXV0b1BsYXlTbGlkZXNTcGVlZCk7XG5cdH1cblxuXHRpbnRyb1NsaWRlcih7XG5cdFx0c2xpZGVyOiAkKCdbZGF0YS1zbGlkZXI9XCJpbnRyb1wiXScpLFxuXHRcdGF1dG9QbGF5OiB0cnVlLFxuXHRcdGF1dG9QbGF5U3BlZWQ6IDUwMDBcblx0fSlcblxuXHRpbnRyb1NsaWRlcih7XG5cdFx0c2xpZGVyOiAkKCdbZGF0YS1zbGlkZXI9XCJzcGVjaWFsaXN0c1wiXScpLFxuXHRcdGF1dG9QbGF5OiB0cnVlLFxuXHRcdGF1dG9QbGF5U3BlZWQ6IDUwMDBcblx0fSlcblxuXHRmdW5jdGlvbiBicmFuZHNTbGlkZXIoKSB7XG5cdFx0ZnVuY3Rpb24gcmVmcmVzaCgpIHtcblx0XHRcdHZhciBzbGlkZXMgPSAkKCcuYnJhbmRzX19saXN0IC5icmFuZCcpLmNoaWxkcmVuKCkubGVuZ3RoLFxuXHRcdFx0XHRjdXJyZW50ID0gJCgnLmJyYW5kLnNsaWNrLWN1cnJlbnQnKSxcblx0XHRcdFx0aW5kZXggPSAkKGN1cnJlbnQpLmluZGV4KCkrMSxcblx0XHRcdFx0aW1nID0gJChjdXJyZW50KS5kYXRhKCdpbWFnZScpLFxuXHRcdFx0XHRpbWFnZSA9ICQoJy5icmFuZHNfX2ltYWdlJyk7XG5cblx0XHRcdGlmIChTdHJpbmcoc2xpZGVzKS5sZW5ndGggPT09IDEpIHNsaWRlcyA9ICcwJytzbGlkZXM7XG5cdFx0XHRpZiAoU3RyaW5nKGluZGV4KS5sZW5ndGggPT09IDEpIGluZGV4ID0gJzAnK2luZGV4O1xuXG5cdFx0XHQkKCcuYnJhbmRzX19jb3VudCBzcGFuJykuZmlyc3QoKS50ZXh0KGluZGV4KTtcblx0XHRcdCQoJy5icmFuZHNfX2NvdW50IHNwYW4nKS5sYXN0KCkudGV4dChzbGlkZXMpO1xuXG5cdFx0XHQkKGltYWdlKS5hZGRDbGFzcygnY2hhbmdlJyk7XG5cblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdCQoaW1hZ2UpLmNzcyh7XG5cdFx0XHRcdFx0J2JhY2tncm91bmQtaW1hZ2UnOiAndXJsKCcraW1nKycpJ1xuXHRcdFx0XHR9KVxuXHRcdFx0XHQkKGltYWdlKS5yZW1vdmVDbGFzcygnY2hhbmdlJyk7XG5cdFx0XHR9LCAxMDApXG5cdFx0fVxuXG5cdFx0JCgnLmJyYW5kc19fbGlzdCcpLnNsaWNrKHtcblx0XHRcdGluZmluaXRlOiB0cnVlLFxuXHRcdFx0ZmFkZTogdHJ1ZSxcblx0XHRcdGFycm93czogdHJ1ZSxcblx0XHRcdGF1dG9wbGF5OiB0cnVlLFxuICBcdFx0XHRhdXRvcGxheVNwZWVkOiA1MDAwLFxuICBcdFx0XHRwYXVzZU9uSG92ZXI6IGZhbHNlLFxuXHRcdFx0cHJldkFycm93OiAkKCcuY29udHJvbHNfYnJhbmRzIC5jb250cm9sc19fYXJyb3dfcHJldicpLFxuXHRcdFx0bmV4dEFycm93OiAkKCcuY29udHJvbHNfYnJhbmRzIC5jb250cm9sc19fYXJyb3dfbmV4dCcpXG5cdFx0fSk7XG5cdFx0XG5cdFx0JCgnLmJyYW5kc19fbGlzdCcpLm9uKCdhZnRlckNoYW5nZScsIHJlZnJlc2gpO1xuXG5cdFx0cmVmcmVzaCgpO1xuXHR9XG5cblx0YnJhbmRzU2xpZGVyKCk7XG5cblx0ZnVuY3Rpb24gZ2FsbGVyeSgpIHtcblx0XHQkKCcuZ2FsbGVyeScpLmVhY2goZnVuY3Rpb24oaSwgZ2FsbGVyeSkge1xuXHRcdFx0aWYgKCQoZ2FsbGVyeSkuaGFzQ2xhc3MoJ2dhbGxlcnlfc3BlYycpKSByZXR1cm47XG5cblx0XHRcdCQoZ2FsbGVyeSkuZmluZCgnLmdhbGxlcnlfX3NsaWRlcycpLnNsaWNrKHtcblx0XHRcdFx0aW5maW5pdGU6IHRydWUsXG5cdFx0XHRcdGF1dG9wbGF5OiAzMDAwLFxuXHRcdFx0XHRzbGlkZXNUb1Nob3c6IDEsXG5cdFx0XHRcdGFycm93czogdHJ1ZSxcblx0XHRcdFx0ZmFkZTogdHJ1ZSxcblx0XHRcdFx0cHJldkFycm93OiAkKCcuY29udHJvbHNfZ2FsbGVyeSAuY29udHJvbHNfX2Fycm93X3ByZXYnKSxcblx0XHRcdFx0bmV4dEFycm93OiAkKCcuY29udHJvbHNfZ2FsbGVyeSAuY29udHJvbHNfX2Fycm93X25leHQnKVxuXHRcdFx0fSk7XG5cblx0XHRcdGZ1bmN0aW9uIHRpdGxlU2V0dXAodGl0bGUpIHtcblx0XHRcdFx0dmFyIGRlbGF5ID0gMTUwO1xuXHRcdFx0XHRcblx0XHRcdFx0JCh0aXRsZXMpLmZhZGVPdXQoZGVsYXksIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdCQodGhpcykuaHRtbCh0aXRsZSkuZmFkZUluKGRlbGF5KVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0dmFyIHRpdGxlcyA9ICQoZ2FsbGVyeSkuZmluZCgnLmdhbGxlcnlfX3RpdGxlJykuZ2V0KDApO1xuXG5cdFx0XHRpZiAodGl0bGVzKSB7XG5cdFx0XHRcdHZhciB0aXRsZSA9ICQoZ2FsbGVyeSkuZmluZCgnLnNsaWNrLWN1cnJlbnQnKS5kYXRhKCd0aXRsZScpO1xuXHRcdFx0XHR0aXRsZVNldHVwKHRpdGxlKTtcblxuXHRcdFx0XHQkKGdhbGxlcnkpLmZpbmQoJy5nYWxsZXJ5X19zbGlkZXMnKS5vbignYmVmb3JlQ2hhbmdlJywgZnVuY3Rpb24oZSwgc2xpY2ssIGN1cnJlbnRTbGlkZSwgbmV4dFNsaWRlKSB7XG5cdFx0XHRcdFx0dmFyIGluZGV4ID0gbmV4dFNsaWRlLFxuXHRcdFx0XHRcdFx0c2xpZGUgPSAkKGdhbGxlcnkpLmZpbmQoJy5nYWxsZXJ5X19pdGVtJykuZ2V0KGluZGV4KSxcblx0XHRcdFx0XHRcdHRpdGxlID0gJChzbGlkZSkuZGF0YSgndGl0bGUnKTtcblxuXHRcdFx0XHRcdHRpdGxlU2V0dXAodGl0bGUpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdH0pO1xuXHR9XG5cblx0Z2FsbGVyeSgpO1xuXG5cblx0Ly8g0J/RgNC+0YHRgtGL0LUg0YHQu9Cw0LnQtNC10YDRi1xuXHQkKCcuc2xpZGVyJykuZWFjaChmdW5jdGlvbihpLCBzbGlkZXIpIHtcblx0XHR2YXIgc2wgPSAkKHNsaWRlcikuZmluZCgnLnNsaWRlcl9fbGlzdCcpO1xuXG5cdFx0c2wuc2xpY2soe1xuXHRcdFx0dmFyaWFibGVXaWR0aDogdHJ1ZSxcblx0XHRcdGNlbnRlck1vZGU6IHRydWUsXG5cdFx0XHRhcnJvd3M6IHRydWUsXG5cdFx0XHRwcmV2QXJyb3c6ICQoc2xpZGVyKS5maW5kKCcuY29udHJvbHNfX2Fycm93X3ByZXYnKSxcblx0XHRcdG5leHRBcnJvdzogJChzbGlkZXIpLmZpbmQoJy5jb250cm9sc19fYXJyb3dfbmV4dCcpXG5cdFx0fSlcblxuXHRcdHZhciBiaWdJbWcgPSAkKHNsaWRlcikuZGF0YSgnYmlnaW1nJyk7XG5cblx0XHRpZiAoYmlnSW1nKSB7XG5cdFx0XHR2YXIgYmlnID0gJCgnLicrYmlnSW1nKS5nZXQoMCk7XG5cblx0XHRcdCQoYmlnKS5odG1sKCQoc2wpLmZpbmQoJy5zbGljay1jdXJyZW50IGltZycpLmNsb25lKCkpO1xuXG5cdFx0XHQkKHNsKS5vbignLnNsaWRlcl9faXRlbScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRcdHZhciBpbWcgPSAkKHRoaXMpLmZpbmQoJ2ltZycpLmNsb25lKCk7XG5cblx0XHRcdFx0JChiaWcpLmVtcHR5KCkuaHRtbChpbWcpO1xuXHRcdFx0fSlcblx0XHR9XG5cdH0pO1xuXG5cdC8vIGJwb3B1cFxuXHQkKCdbZGF0YS1icG9wdXBdJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdHZhciBpbWcgPSAkKHRoaXMpLmZpbmQoJ2ltZycpLmNsb25lKCksXG5cdFx0XHRpbWdXcmFwID0gJzxkaXYgY2xhc3M9XCJicG9wdXAtd3JhcC1pbWFnZVwiPjwvZGl2Pic7XG5cblx0XHQkKCdib2R5JykuYXBwZW5kKGltZ1dyYXApO1xuXHRcdCQoaW1nV3JhcCkuYXBwZW5kKGltZykuYlBvcHVwKCkucmVwb3NpdGlvbigzMDApO1xuXHRcdFxuXG5cdH0pXG5cblx0Ly8g0JrQsNGA0YLQsFxuXHR2YXIgbWFwID0gJCgnI21hcCcpLmdldCgwKTtcblxuXHRpZiAobWFwKSB7XG5cdFx0eW1hcHMucmVhZHkoaW5pdCk7XG5cblx0ICAgIHZhciBteU1hcCwgXG5cdCAgICAgICAgbXlQbGFjZW1hcms7XG5cblx0ICAgIGZ1bmN0aW9uIGluaXQoKXsgXG5cdCAgICAgICAgbXlNYXAgPSBuZXcgeW1hcHMuTWFwKFwibWFwXCIsIHtcblx0ICAgICAgICAgICAgY2VudGVyOiBbNTMuMzM0MTM2LCA4My43OTMyNDddLFxuXHQgICAgICAgICAgICB6b29tOiAxNyxcblx0ICAgICAgICAgICAgY29udHJvbHM6IFtdXG5cdCAgICAgICAgfSk7IFxuXHQgICAgICAgIFxuXHQgICAgICAgIG15UGxhY2VtYXJrID0gbmV3IHltYXBzLlBsYWNlbWFyayhbNTMuMzM0MTM2LCA4My43OTMyNDddLCB7XG5cdCAgICAgICAgICAgIGhpbnRDb250ZW50OiAn0KLQlCBVbHRyYSdcblx0ICAgICAgICB9KTtcblx0ICAgICAgICBcblx0ICAgICAgICBteU1hcC5nZW9PYmplY3RzLmFkZChteVBsYWNlbWFyayk7XG5cdCAgICB9XG5cdH1cblxuXHQvLyDQmtGA0LDRgdC40LLRi9C1INGB0LXQu9C10LrRgtGLXG5cdCQoJ3NlbGVjdCcpLm5pY2VTZWxlY3QoKTtcblxuXHQvLyDQnNC+0LHQuNC70YzQvdC+0LUg0LzQtdC90Y5cblx0JCgnLm1lbnUnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHQkKHRoaXMpLnBhcmVudCgpLnRvZ2dsZUNsYXNzKCdtZW51LW9wZW4nKTtcblx0fSk7XG5cblx0Ly8g0J/QvtC40YHQulxuXHRzZWFyY2hDb21wb25lbnQoKTtcblxuXHRmdW5jdGlvbiBzZWFyY2hDb21wb25lbnQoKSB7XG5cdFx0dmFyIHNlYXJjaCA9ICQoJy5zZWFyY2gnKTtcblxuXHRcdCQoJy5zZWFyY2hfX2J0bicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCQod2luZG93KS53aWR0aCgpID4gNzY4KSByZXR1cm47XG5cblx0XHRcdCQoc2VhcmNoKS50b2dnbGVDbGFzcygnc2VhcmNoLW9wZW4nKTtcblx0XHRcdCQoc2VhcmNoKS5maW5kKCdpbnB1dCcpLmZvY3VzKCk7XG5cdFx0fSk7XG5cblx0XHQkKCcuc2VhcmNoX19jbGVhcicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0JChzZWFyY2gpLmZpbmQoJy5zZWFyY2hfX2ZpZWxkIGlucHV0JykudmFsKCcnKS5mb2N1cygpO1xuXHRcdH0pO1xuXHR9XG5cblx0Ly8g0KHRgNCw0LLQvdC10L3QuNC1XG5cdCQoJy5yZXN1bHRfX2NvbXBhcmUnKS50d2VudHl0d2VudHkoe1xuXHRcdGJlZm9yZV9sYWJlbDogJ9CU0L4nLFxuXHRcdGFmdGVyX2xhYmVsOiAn0J/QvtGB0LvQtSdcblx0fSk7XG5cblx0Ly8gdGlsdCBqc1xuXHQkKCcuc2VydGlmaWNhdGUnKS50aWx0KCk7XG5cblx0Ly8g0J/Qu9Cw0LLQsNGO0YnQsNGPINGI0LDQv9C60LBcblx0JCgnYm9keScpLmFwcGVuZCgkKCcuaGVhZGVyX19tYWluJykuY2xvbmUoKS5hZGRDbGFzcygnZml4ZWQnKSk7XG5cblx0JCh3aW5kb3cpLm9uKCdzY3JvbGwnLCBmdW5jdGlvbigpIHtcblx0XHRpZiAoJCh3aW5kb3cpLndpZHRoKCkgPD0gMTAwMCkge1xuXHRcdFx0JCgnLmhlYWRlcl9fbWFpbi5maXhlZC5zaG93JykucmVtb3ZlQ2xhc3MoJ3Nob3cnKTtcblx0XHRcdHJldHVyblxuXHRcdH1cblxuXHRcdHZhciBzY3JvbGwgPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7XG5cblx0XHRpZiAoc2Nyb2xsID49IDIwMCkge1xuXHRcdFx0JCgnLmhlYWRlcl9fbWFpbi5maXhlZCcpLmFkZENsYXNzKCdzaG93Jyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdCQoJy5oZWFkZXJfX21haW4uZml4ZWQuc2hvdycpLnJlbW92ZUNsYXNzKCdzaG93Jyk7XG5cdFx0fVxuXHR9KTtcblxuXHQvLyDQnNC+0LTQsNC70YzQvdGL0LUg0L7QutC90LBcblx0JCgnW2RhdGEtb3Blbl0nKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0dmFyIG1vZGFsID0gJCgnW2RhdGEtbW9kYWw9XCInKyQodGhpcykuZGF0YSgnb3BlbicpKydcIl0nKS5nZXQoMCk7XG5cblx0XHQkKG1vZGFsKS5iUG9wdXAoe1xuXHRcdFx0Y2xvc2VDbGFzczogJ21vZGFsX19jbG9zZSdcblx0XHR9KTtcblx0fSk7XG5cbn0pOyJdfQ==
